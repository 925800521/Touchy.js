/*
	Touchy.js
	Socket-style finger management for touch events

	Jairaj Sethi
*/
(function(){function m(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&(a=a.attachEvent("on"+b,c),e[a]={name:b,callback:c})}function j(a){this.id=a;this.points=[];this.callbacks={start:[],move:[],end:[]}}function o(a){j.prototype[a+"Event"]=function(b){this.points.push(b);this.trigger(a)}}function g(a){this.fingers=!a?[]:k(a,function(a){return new j(a)});this.callbacks={start:[],move:[],end:[]}}function p(a){g.prototype[a+"Event"]=function(b){var c=this;h(b,function(b){h(c.fingers,
function(c){if(c.id==b.id)c[a+"Event"](b)})});this.trigger(a)}}function t(a,b){return k(a,function(a){return{id:a.identifier,x:a.pageX,y:a.pageY,time:b}})}function q(a,b){function c(a,c){var i=t(a[c?"changedTouches":"touches"],a.timeStamp),e=i.length,l=e!=f;h(i,function(a){var d=n.get(a.id);c?d&&(d.endEvent(a),n.remove(d)):d?d.moveEvent(a):(d=new j(a.id),n.add(d),b.any&&b.any(n,d),d.startEvent(a))});l||h(i,function(a){d.has(a.id)||(l=!0)});l||d.moveEvent(i);if(d&&(l||c))c||k(d.fingers,function(a){return a.points[a.points.length-
1]}),d.endEvent(i),d=null,f=0;l&&(d=new g(k(i,function(a){return a.id})),f=e,(e=b[{1:"one",2:"two",3:"three",4:"four",5:"five"}[f]])&&e.apply(window,[d].concat(d.fingers)),d.startEvent(i))}"function"==typeof b&&(b={any:b});var d,n=new g,f=0;m(a,"touchstart",function(a){c(a,!1)});m(a,"touchmove",function(a){c(a,!1)});m(a,"touchend",function(a){c(a,!0)})}var h=function(){return Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=0,e=a.length;d<e;d++)d in
a&&b.call(c,a[d],d,a)}}(),s=function(){return Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){for(var c=c||0,d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1}}(),k=function(){return Array.prototype.map?function(a,b,c){return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=0;f<d;f++)f in a&&(e[f]=b.call(c,a[f],f,a));return e}}(),e={};j.prototype.on=function(a,b){this.callbacks[a].push(b)};j.prototype.trigger=
function(a){var b=this,c=b.points[b.points.length-1];h(this.callbacks[a],function(a){a.call(b,c)})};o("start");o("move");o("end");g.prototype.add=function(a){-1==s(this.fingers,a)&&this.fingers.push(a)};g.prototype.remove=function(a){a=s(this.fingers,a);-1!=a&&this.fingers.splice(a,1)};g.prototype.count=function(){return this.fingers.length};g.prototype.get=function(a){var b;h(this.fingers,function(c){c.id==a&&(b=c)});return b};g.prototype.has=function(a){var b=!1;h(this.fingers,function(c){c.id==
a&&(b=!0)});return b};g.prototype.on=function(a,b){this.callbacks[a].push(b)};g.prototype.trigger=function(a){var b=this,c=k(b.fingers,function(a){return a.points[a.points.length-1]});h(this.callbacks[a],function(a){a.call(b,c)})};p("start");p("move");p("end");var r=function(a){a.preventDefault()};q.stopWindowBounce=function(){m(window,"touchmove",r)};q.startWindowBounce=function(){var a=window;if(a.removeEventListener)a.removeEventListener("touchmove",r,!1);else if(a.detachEvent)for(var b in e)"touchmove"===
e[b].name&&e[b].callback===r&&(a.detachEvent(b),delete e[b])};window.Touchy=q})();
